# План проекта «Радиатор» (SIMULACIA)

## Данные по объекту

| Параметр | Значение |
|----------|----------|
| Модули | main, draw, physics, hydraulics, constants, state, types, particle |
| Секций радиатора | 10 |
| Радиаторов на стояке | 10 |
| Номинальная мощность | 2000 Вт |
| Подача/обратка ном. | 75/65°C |
| T_комнаты ном. | 20°C |
| ΔT_воды ном. | 10 K |
| COLD_THRESHOLD | 30°C |
| FREEZE_THRESHOLD | 2.0°C |
| THAW_THRESHOLD | 5.0°C |

---

## Thermal Model (тепловая модель)

### Part A — одиночный радиатор

- **Метод**: ε-NTU (Number of Transfer Units)
- **Формулы**:
  - ε = 1 − exp(−NTU)
  - NTU = hA / (G × Cp)
  - Q = ε × G × Cp × (T_подачи − T_room)
  - T_обр = T_подачи − Q / (G × Cp)
- **Калибровка**: по номинальным данным (75/65/20°C, ΔT_воды=10 K)
- **Баланс**: Q_рад = Q_потерь, поиск T_room методом **Ньютона-Рафсона**
- **Разморозка**: при retT > THAW_THRESHOLD секция размораживается

### Part B — стояк однотрубной системы

- 10 радиаторов, последовательный расчёт по этажам
- Перемычки (байпасы): открыта/закрыта — влияет на расход
- При закрытых перемычках: падение расхода, последние радиаторы получают холодную воду

---

## Схема (см. ARCHITECTURE.md)

- main → constants, state, particle, physics, hydraulics, draw
- draw → constants, state
- hydraulics → physics

---

## To-do

- [ ] physics.ts, hydraulics.ts: передавать параметры явно вместо gv() из DOM
- [ ] draw.ts: при росте — разбить на drawPipes, drawRadiator, drawCollectors
- [ ] drawPipes(): по Rule 2 — при упрощении оставлять только подписи температур (сейчас: полная отрисовка труб)

---

## Журнал изменений

| Дата | Изменение |
|------|-----------|
| 2026-02-21 | Добавлен plan.md по стандартам workspace |
| 2026-02-21 | Проверка drawPipes: полная отрисовка труб; при упрощении — только подписи температур (Rule 2) |
| 2026-02-28 | Перенос симуляции 6 радиаторов из вкладки «Визуализация» во вкладку «Расчёт стояка»; добавлены блоки «Краны на байпасах 1/2"» и «Размеры и позиция» в riser-calc-section |
