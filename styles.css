*{box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);color:#1e293b;margin:0;padding:0}
.canvas-container{background:linear-gradient(180deg,#f1f5f9 0%,#e2e8f0 50%,#cbd5e1 100%);border-radius:24px;box-shadow:0 25px 80px rgba(0,0,0,.15),inset 0 2px 0 rgba(255,255,255,.8);padding:20px;border:1px solid rgba(148,163,184,.4)}
canvas{display:block;width:100%;height:auto;border-radius:16px;background:linear-gradient(180deg,#fef3c7 0%,#fef9c3 30%,#ecfdf5 100%);box-shadow:inset 0 4px 20px rgba(0,0,0,.1)}
.metric-card{background:#fff;border:1px solid #e2e8f0;border-radius:16px;padding:20px;transition:all .3s;box-shadow:0 4px 15px rgba(0,0,0,.05)}
.metric-card:hover{border-color:#3b82f6;box-shadow:0 10px 40px rgba(59,130,246,.15);transform:translateY(-2px)}
/* === ОБНОВЛЕННЫЕ КОМПАКТНЫЕ СТИЛИ КНОПОК === */
.mode-btn {
    transition: all .2s cubic-bezier(.4, 0, .2, 1);
    font-weight: 600;
    min-width: auto;
}
.mode-btn:hover {
    transform: translateY(-1px);
}
.mode-active {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, .15);
}
.stat-value{font-family:'JetBrains Mono',monospace;font-size:1.5rem;font-weight:700}
.stat-value-lg{font-family:'JetBrains Mono',monospace;font-size:2.5rem;font-weight:700}
input[type="range"]{-webkit-appearance:none;height:8px;border-radius:4px;background:#e2e8f0}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#1d4ed8);cursor:pointer;box-shadow:0 2px 8px rgba(59,130,246,.4)}
.power-input{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:600;width:90px;text-align:center;border:2px solid #e2e8f0;border-radius:8px;padding:6px}
.power-input:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.2)}
.section-card{background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:10px;text-align:center;position:relative}
.section-card .tooltip{display:none;position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:#1e293b;color:#f1f5f9;padding:12px;border-radius:10px;font-size:.75rem;width:240px;z-index:10;line-height:1.6;box-shadow:0 8px 20px rgba(0,0,0,.3)}
.section-card:hover .tooltip{display:block}
.section-card .tooltip::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:6px solid transparent;border-top-color:#1e293b}
.temp-gradient{height:24px;border-radius:12px}
.balance-card{background:linear-gradient(135deg,#fef3c7,#fde68a);border:3px solid #f59e0b}
.comfort-good{background:linear-gradient(135deg,#dcfce7,#bbf7d0);border-color:#22c55e}
.comfort-warn{background:linear-gradient(135deg,#fef3c7,#fde68a);border-color:#f59e0b}
.comfort-bad{background:linear-gradient(135deg,#fee2e2,#fecaca);border-color:#ef4444}
.iter-log{font-family:'JetBrains Mono',monospace;font-size:.7rem;max-height:120px;overflow-y:auto}
.bypass-control{background:linear-gradient(135deg,#fef3c7,#fed7aa);border:2px solid #f97316;border-radius:12px;padding:15px}
.flow-indicator{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;font-family:'JetBrains Mono',monospace;font-size:.9rem}
.export-btn {
    background: #fff;
    color: #1e293b;
    padding: 6px 12px;
    border: 2px solid #cbd5e1;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all .2s;
}
.export-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, .1);
    border-color: #94a3b8;
}
.author-badge{background:linear-gradient(135deg,#4f46e5,#7c3aed);color:#fff;padding:8px 16px;border-radius:10px;display:inline-flex;align-items:center;gap:8px;font-size:.85rem;box-shadow:0 4px 12px rgba(79,70,229,.3);text-decoration:none}
.author-badge:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(79,70,229,.4)}
.sp-ref{background:#eff6ff;border:1px solid #bfdbfe;border-radius:8px;padding:8px 12px;font-size:.8rem;color:#1e40af;margin-top:4px}
.riser-section{background:linear-gradient(135deg,#fdf4ff,#ede9fe);border:2px solid #8b5cf6;border-radius:12px;padding:20px;margin-top:16px}
.riser-floor-row{display:grid;grid-template-columns:60px 1fr 100px 100px 100px 80px;gap:8px;align-items:center;padding:6px 8px;border-radius:8px;font-family:'JetBrains Mono',monospace;font-size:.8rem;transition:all .2s}
.riser-floor-row:hover{transform:scale(1.01)}
.riser-floor-row.floor-header{font-family:'Inter',sans-serif;font-weight:700;font-size:.7rem;color:#6b7280;text-transform:uppercase;background:transparent!important}
.riser-bypass-toggle{width:36px;height:20px;border-radius:10px;border:none;cursor:pointer;position:relative;transition:all .2s}
.riser-bypass-toggle.open{background:#22c55e}
.riser-bypass-toggle.closed{background:#ef4444}
.riser-bypass-toggle::after{content:'';position:absolute;top:2px;width:16px;height:16px;border-radius:50%;background:#fff;transition:all .2s}
.riser-bypass-toggle.open::after{left:18px}
.riser-bypass-toggle.closed::after{left:2px}
.riser-temp-bar{height:12px;border-radius:6px;position:relative;overflow:hidden}
.riser-temp-bar-fill{height:100%;border-radius:6px;transition:width .3s}
.riser-summary-card{background:#fff;border:1px solid #a78bfa;border-radius:6px;padding:6px 8px;text-align:center}
.riser-summary-card .stat-value{font-size:.75rem;font-weight:700}
.riser-summary-card .text-xs{font-size:.6rem}
.riser-warning{background:linear-gradient(135deg,#fef2f2,#fecaca);border:2px solid #ef4444;border-radius:10px;padding:12px;margin-top:12px}
.riser-ok{background:linear-gradient(135deg,#ecfdf5,#d1fae5);border:2px solid #22c55e;border-radius:10px;padding:12px;margin-top:12px}
.riser-param-input{font-family:'JetBrains Mono',monospace;font-size:.9rem;font-weight:600;width:70px;text-align:center;border:2px solid #d8b4fe;border-radius:6px;padding:4px}
.riser-param-input:focus{outline:none;border-color:#8b5cf6;box-shadow:0 0 0 3px rgba(139,92,246,.2)}
.riser-visual-pipe{width:8px;background:linear-gradient(180deg,#ef4444,#f97316,#3b82f6);border-radius:4px;margin:0 auto}
.riser-floor-indicator{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.65rem;font-weight:700;color:#fff}

/* === СТИЛИ для потока в коллекторе обратки === */
.collector-flow-info{background:linear-gradient(135deg,#fef2f2,#fff7ed);border:2px solid #fb923c;border-radius:10px;padding:12px;margin-top:8px}
.collector-temp-badge{display:inline-block;padding:2px 8px;border-radius:6px;font-family:'JetBrains Mono',monospace;font-size:.75rem;font-weight:700}

/* === НОВОЕ: Кнопка противотока === */
.counterflow-btn {
    transition: all .3s;
}
.counterflow-btn.active {
    background: #fff;
    color: #1e293b;
    border: 2px solid #94a3b8;
    box-shadow: 0 2px 8px rgba(0, 0, 0, .1);
}
.counterflow-btn.inactive {
    background: #f1f5f9;
    color: #64748b;
    border: 2px solid #e2e8f0;
}
